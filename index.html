<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AR.js Hiro & Kanji Distance</title>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <style>
    .overlay {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.8);
      color: #fff;
      padding: 10px 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      z-index: 1000;
    }
  </style>
</head>
<body style="margin: 0; overflow: hidden;">

  <div id="distanceOverlay" class="overlay">
    Distance: <span id="distValue">--</span> m
  </div>

  <a-scene
    embedded
    arjs="sourceType: webcam; debugUIEnabled: false;"
    renderer="logarithmicDepthBuffer: true;"
  >
    <!-- Marker 1: HIRO -->
    <a-marker id="marker1" preset="hiro">
      <a-box position="0 0.5 0" color="#FF0000"></a-box>
    </a-marker>

    <!-- Marker 2: KANJI -->
    <a-marker id="marker2" preset="kanji">
      <a-box position="0 0.5 0" color="#0000FF"></a-box>
    </a-marker>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    const marker1 = document.getElementById('marker1');
    const marker2 = document.getElementById('marker2');
    const distSpan = document.getElementById('distValue');

    let m1Visible = false;
    let m2Visible = false;

    marker1.addEventListener('markerFound', () => { m1Visible = true;  });
    marker1.addEventListener('markerLost',  () => { m1Visible = false; });
    marker2.addEventListener('markerFound', () => { m2Visible = true;  });
    marker2.addEventListener('markerLost',  () => { m2Visible = false; });

    function updateDistance() {
      if (m1Visible && m2Visible &&
          marker1.object3D && marker2.object3D) {

        const p1 = marker1.object3D.position;
        const p2 = marker2.object3D.position;

        const dx = p1.x - p2.x;
        const dy = p1.y - p2.y;
        const dz = p1.z - p2.z;
        const dist = Math.sqrt(dx*dx + dy*dy + dz*dz);

        distSpan.textContent = dist.toFixed(3);
      } else {
        distSpan.textContent = "--";
      }
    }

    setInterval(updateDistance, 100);
  </script>
</body>
</html>
